<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Shopping Cart</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Set up custom configuration for Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="min-h-screen antialiased">

    <!-- Shopping Cart Container -->
    <div class="container mx-auto p-4 sm:p-8 lg:p-12">
        <header class="mb-8">
            <h1 class="text-4xl font-extrabold text-gray-900 tracking-tight mb-2">Shopping Cart</h1>
            <p class="text-lg text-gray-500">Review your items before checkout.</p>
        </header>

        <!-- Main Content Grid -->
        <div class="lg:grid lg:grid-cols-3 lg:gap-8">
            
            <!-- Cart Items List (2/3 width on large screens) -->
            <div id="cart-items-container" class="lg:col-span-2 space-y-4">
                <!-- Cart items will be rendered here by JavaScript -->
                <div id="cart-items" class="bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100 min-h-60 flex items-center justify-center">
                    <p class="text-gray-500 italic">Loading cart items...</p>
                </div>
            </div>

            <!-- Order Summary Sidebar (1/3 width on large screens) -->
            <div class="lg:col-span-1 mt-8 lg:mt-0 sticky top-4">
                <div id="cart-summary" class="bg-indigo-50 p-6 rounded-xl shadow-xl border border-indigo-200">
                    <h2 class="text-2xl font-bold text-indigo-900 mb-6">Order Summary</h2>
                    
                    <div class="space-y-4 text-gray-700">
                        <div class="flex justify-between border-b border-indigo-200 pb-3">
                            <span>Subtotal (<span id="item-count">0</span> items)</span>
                            <span id="subtotal" class="font-medium">$0.00</span>
                        </div>
                        
                        <div class="flex justify-between">
                            <span>Shipping Estimate</span>
                            <span id="shipping" class="font-medium text-green-600">Free</span>
                        </div>

                        <div class="flex justify-between border-b border-indigo-200 pb-4">
                            <span>Tax Estimate (7.5%)</span>
                            <span id="tax" class="font-medium">$0.00</span>
                        </div>
                        
                        <div class="flex justify-between pt-4 text-xl font-extrabold text-gray-900">
                            <span>Order Total</span>
                            <span id="total">$0.00</span>
                        </div>
                    </div>

                    <button class="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-lg transition duration-200 shadow-md transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50"
                        onclick="alert('Proceeding to Checkout! Total: ' + document.getElementById('total').textContent)">
                        Proceed to Checkout
                    </button>

                    <div class="mt-4 text-center text-sm text-indigo-800">
                        <a href="#" class="hover:underline">Continue Shopping</a>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- JavaScript for Cart Logic -->
    <script>
        // Use a global variable to store the cart state
        let cart = [];
        
        // Mock data for initial load
        const initialCart = [
            { 
                id: 1, 
                name: 'Wireless Mechanical Keyboard', 
                price: 129.99, 
                quantity: 1, 
                imageUrl: 'https://placehold.co/100x100/1e3a8a/ffffff?text=Keyboard' 
            },
            { 
                id: 2, 
                name: '4K Ultra HD Monitor', 
                price: 449.99, 
                quantity: 2, 
                imageUrl: 'https://placehold.co/100x100/b91c1c/ffffff?text=Monitor' 
            },
            { 
                id: 3, 
                name: 'Ergonomic Mouse', 
                price: 49.99, 
                quantity: 1, 
                imageUrl: 'https://placehold.co/100x100/059669/ffffff?text=Mouse' 
            }
        ];

        // Constants
        const TAX_RATE = 0.075;
        const SHIPPING_COST = 0; // For simplicity, shipping is free in this example

        /**
         * Calculates the subtotal, tax, and total based on the current cart state.
         * Updates the Order Summary section in the DOM.
         */
        function calculateTotal() {
            let subtotal = 0;
            let totalItemCount = 0;

            cart.forEach(item => {
                subtotal += item.price * item.quantity;
                totalItemCount += item.quantity;
            });

            const tax = subtotal * TAX_RATE;
            const total = subtotal + tax + SHIPPING_COST;

            // Update DOM elements
            document.getElementById('item-count').textContent = totalItemCount;
            document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('total').textContent = `$${total.toFixed(2)}`;
            document.getElementById('shipping').textContent = SHIPPING_COST === 0 ? 'Free' : `$${SHIPPING_COST.toFixed(2)}`;

            // Update the checkout button text
            const checkoutButton = document.querySelector('#cart-summary button');
            checkoutButton.onclick = () => {
                // Using a custom message box instead of alert()
                showUserMessage(`Proceeding to Checkout! Total: $${total.toFixed(2)}`);
            };
        }

        /**
         * Renders the entire cart contents to the DOM.
         */
        function renderCart() {
            const cartItemsContainer = document.getElementById('cart-items');
            cartItemsContainer.innerHTML = ''; // Clear existing items

            if (cart.length === 0) {
                cartItemsContainer.className = "bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100 min-h-60 flex items-center justify-center";
                cartItemsContainer.innerHTML = '<p class="text-xl font-semibold text-gray-500 italic">Your cart is empty.</p>';
                document.getElementById('cart-summary').classList.add('opacity-50');
            } else {
                cartItemsContainer.className = "space-y-6"; // Restore spacing layout
                document.getElementById('cart-summary').classList.remove('opacity-50');

                cart.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'flex flex-col sm:flex-row items-start sm:items-center bg-white p-4 rounded-xl shadow-md transition duration-150 hover:shadow-lg';
                    
                    // HTML structure for a single cart item
                    itemElement.innerHTML = `
                        <!-- Item Image -->
                        <div class="flex-shrink-0 w-24 h-24 sm:w-28 sm:h-28 rounded-lg overflow-hidden border border-gray-200 mb-4 sm:mb-0">
                            <img src="${item.imageUrl}" alt="${item.name}" class="w-full h-full object-cover" 
                                onerror="this.onerror=null; this.src='https://placehold.co/100x100/cccccc/000000?text=Product+Image';"
                            >
                        </div>

                        <!-- Item Details -->
                        <div class="flex-grow sm:ml-6 w-full">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="text-lg font-bold text-gray-900">${item.name}</h3>
                                <button onclick="removeItem(${item.id})" class="text-red-500 hover:text-red-700 transition duration-150 p-1 -mt-2 sm:mt-0">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 10-2 0v6a1 1 0 102 0V8z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                            <p class="text-sm text-gray-500 mb-3">Price per item: <span class="font-medium">$${item.price.toFixed(2)}</span></p>

                            <!-- Quantity and Subtotal -->
                            <div class="flex justify-between items-center mt-4">
                                <div class="flex items-center space-x-2">
                                    <label for="quantity-${item.id}" class="text-sm text-gray-600">Quantity:</label>
                                    <div class="flex border border-gray-300 rounded-lg overflow-hidden">
                                        <button onclick="updateQuantity(${item.id}, -1)" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition duration-150 focus:outline-none focus:ring-2 focus:ring-indigo-500">-</button>
                                        <input type="number" id="quantity-${item.id}" value="${item.quantity}" min="1" 
                                               onchange="updateQuantityInput(${item.id}, this.value)"
                                               class="w-12 text-center border-none text-gray-900 font-medium focus:outline-none p-1">
                                        <button onclick="updateQuantity(${item.id}, 1)" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition duration-150 focus:outline-none focus:ring-2 focus:ring-indigo-500">+</button>
                                    </div>
                                </div>
                                <div class="text-xl font-extrabold text-indigo-600">
                                    $<span id="item-subtotal-${item.id}">${(item.price * item.quantity).toFixed(2)}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                });
            }

            calculateTotal();
        }

        /**
         * Updates the quantity of a specific item in the cart.
         * @param {number} itemId - The ID of the item to update.
         * @param {number} delta - The amount to change the quantity by (+1 or -1).
         */
        function updateQuantity(itemId, delta) {
            const item = cart.find(i => i.id === itemId);
            if (item) {
                const newQuantity = item.quantity + delta;
                if (newQuantity >= 1) {
                    item.quantity = newQuantity;
                    // Directly update the input field and individual item subtotal
                    document.getElementById(`quantity-${itemId}`).value = newQuantity;
                    document.getElementById(`item-subtotal-${itemId}`).textContent = (item.price * newQuantity).toFixed(2);
                    calculateTotal();
                } else if (newQuantity === 0) {
                    removeItem(itemId);
                }
            }
        }

        /**
         * Updates the quantity of a specific item based on direct input.
         * @param {number} itemId - The ID of the item to update.
         * @param {string} value - The new quantity value from the input field.
         */
        function updateQuantityInput(itemId, value) {
            const newQuantity = parseInt(value);
            const item = cart.find(i => i.id === itemId);

            if (item) {
                if (newQuantity >= 1) {
                    item.quantity = newQuantity;
                    document.getElementById(`item-subtotal-${itemId}`).textContent = (item.price * newQuantity).toFixed(2);
                    calculateTotal();
                } else {
                    // Reset input to 1 if user tries to set less than 1, or remove if they manually set to 0 (though min="1" should prevent this)
                    document.getElementById(`quantity-${itemId}`).value = 1;
                    item.quantity = 1;
                    calculateTotal();
                }
            }
        }

        /**
         * Removes an item from the cart array and re-renders the cart.
         * @param {number} itemId - The ID of the item to remove.
         */
        function removeItem(itemId) {
            const initialLength = cart.length;
            cart = cart.filter(item => item.id !== itemId);
            
            if (cart.length < initialLength) {
                showUserMessage('Item removed from cart!', 'bg-yellow-100 text-yellow-800');
            }
            
            renderCart();
        }

        /**
         * Displays a simple, temporary message to the user (instead of alert()).
         * @param {string} message - The message text.
         * @param {string} classes - Tailwind classes for styling the box.
         */
        function showUserMessage(message, classes = 'bg-indigo-100 text-indigo-800') {
            const container = document.getElementById('cart-items-container');
            
            // Check if a message box already exists and remove it
            let messageBox = document.getElementById('user-message-box');
            if (messageBox) {
                messageBox.remove();
            }

            messageBox = document.createElement('div');
            messageBox.id = 'user-message-box';
            messageBox.className = `p-4 mb-4 rounded-lg font-medium shadow-md transition-opacity duration-300 ${classes}`;
            messageBox.textContent = message;

            container.prepend(messageBox);

            // Automatically hide after 3 seconds
            setTimeout(() => {
                messageBox.classList.add('opacity-0');
                // Remove from DOM after transition
                setTimeout(() => messageBox.remove(), 300); 
            }, 3000);
        }

        // Initialize the cart on page load
        window.onload = function() {
            // Load initial mock data
            cart = initialCart;
            renderCart();
        };

    </script>
</body>
</html>
